MATCH (u:User)
WHERE u.enabled = true AND u.lastLogin >= datetime().minusMonths(6) AND NOT (u)-[:CHANGED_PASSWORD]->() AND (u)-[:MEMBER_OF]->(g:Group {name: "Domain Users"})
RETURN u;